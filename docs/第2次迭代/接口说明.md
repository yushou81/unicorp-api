# 第二次迭代API接口说明

本文档详细说明第二次迭代中实现的API接口，包括岗位管理和岗位申请相关功能。

## 1. 岗位管理接口

### 1.1 获取岗位列表

**接口说明**：获取所有状态为'open'的岗位列表，支持分页和关键词搜索。

**请求方式**：GET

**接口地址**：`/v1/jobs`

**请求参数**：

| 参数名 | 类型   | 必填 | 说明                     |
| ------ | ------ | ---- | ------------------------ |
| page   | int    | 否   | 页码，默认0              |
| size   | int    | 否   | 每页大小，默认10         |
| keyword| string | 否   | 搜索关键词，匹配标题和描述 |

**响应示例**：

```json
{
  "code": 200,
  "message": "获取岗位列表成功",
  "data": {
    "records": [
      {
        "id": 1,
        "organizationId": 2,
        "organizationName": "测试企业",
        "postedByUserId": 3,
        "title": "Java开发工程师",
        "description": "负责公司核心业务系统的开发和维护",
        "location": "北京市海淀区",
        "status": "open",
        "createdAt": "2025-06-27T10:00:00"
      },
      // 更多岗位...
    ],
    "total": 10,
    "size": 10,
    "current": 0,
    "pages": 1
  }
}
```

### 1.2 创建新岗位

**接口说明**：由企业管理员或企业导师调用，用于发布一个新的招聘岗位。

**请求方式**：POST

**接口地址**：`/v1/jobs`

**权限要求**：需要企业管理员或企业导师角色

**请求参数**：

| 参数名      | 类型   | 必填 | 说明         |
| ----------- | ------ | ---- | ------------ |
| title       | string | 是   | 岗位标题     |
| description | string | 是   | 岗位描述     |
| location    | string | 否   | 工作地点     |

**请求示例**：

```json
{
  "title": "前端开发工程师",
  "description": "负责公司Web前端开发和维护",
  "location": "上海市浦东新区"
}
```

**响应示例**：

```json
{
  "code": 200,
  "message": "岗位创建成功",
  "data": {
    "id": 2,
    "organizationId": 2,
    "organizationName": "测试企业",
    "postedByUserId": 3,
    "title": "前端开发工程师",
    "description": "负责公司Web前端开发和维护",
    "location": "上海市浦东新区",
    "status": "open",
    "createdAt": "2025-06-27T11:30:00"
  }
}
```

### 1.3 获取特定岗位详情

**接口说明**：根据ID获取岗位的详细信息。

**请求方式**：GET

**接口地址**：`/v1/jobs/{id}`

**请求参数**：

| 参数名 | 类型 | 必填 | 说明    |
| ------ | ---- | ---- | ------- |
| id     | int  | 是   | 岗位ID  |

**响应示例**：

```json
{
  "code": 200,
  "message": "获取岗位详情成功",
  "data": {
    "id": 1,
    "organizationId": 2,
    "organizationName": "测试企业",
    "postedByUserId": 3,
    "title": "Java开发工程师",
    "description": "负责公司核心业务系统的开发和维护",
    "location": "北京市海淀区",
    "status": "open",
    "createdAt": "2025-06-27T10:00:00"
  }
}
```

### 1.4 更新岗位信息

**接口说明**：更新已发布岗位的信息。

**请求方式**：PUT

**接口地址**：`/v1/jobs/{id}`

**权限要求**：需要企业管理员或企业导师角色，且只能修改自己企业的岗位

**请求参数**：

| 参数名      | 类型   | 必填 | 说明         |
| ----------- | ------ | ---- | ------------ |
| id          | int    | 是   | 岗位ID       |
| title       | string | 是   | 岗位标题     |
| description | string | 是   | 岗位描述     |
| location    | string | 否   | 工作地点     |

**请求示例**：

```json
{
  "title": "高级Java开发工程师",
  "description": "负责公司核心业务系统的架构设计和开发",
  "location": "北京市朝阳区"
}
```

**响应示例**：

```json
{
  "code": 200,
  "message": "岗位更新成功",
  "data": {
    "id": 1,
    "organizationId": 2,
    "organizationName": "测试企业",
    "postedByUserId": 3,
    "title": "高级Java开发工程师",
    "description": "负责公司核心业务系统的架构设计和开发",
    "location": "北京市朝阳区",
    "status": "open",
    "createdAt": "2025-06-27T10:00:00"
  }
}
```

### 1.5 删除岗位

**接口说明**：逻辑删除一个岗位。

**请求方式**：DELETE

**接口地址**：`/v1/jobs/{id}`

**权限要求**：需要企业管理员或企业导师角色，且只能删除自己企业的岗位

**请求参数**：

| 参数名 | 类型 | 必填 | 说明    |
| ------ | ---- | ---- | ------- |
| id     | int  | 是   | 岗位ID  |

**响应**：
- 状态码: 204 No Content
- 无响应体

## 2. 岗位申请接口

### 2.1 申请岗位

**接口说明**：学生用户申请一个岗位。

**请求方式**：POST

**接口地址**：`/v1/jobs/{id}/apply`

**权限要求**：需要学生角色

**请求参数**：

| 参数名 | 类型 | 必填 | 说明    |
| ------ | ---- | ---- | ------- |
| id     | int  | 是   | 岗位ID  |

**响应示例**：

```json
{
  "code": 200,
  "message": "岗位申请成功",
  "data": 1  // 申请ID
}
```

### 2.2 查看岗位申请列表

**接口说明**：企业用户查看指定岗位的申请人列表。

**请求方式**：GET

**接口地址**：`/v1/jobs/{id}/applications`

**权限要求**：需要企业管理员或企业导师角色，且只能查看自己企业的岗位申请

**请求参数**：

| 参数名 | 类型 | 必填 | 说明         |
| ------ | ---- | ---- | ------------ |
| id     | int  | 是   | 岗位ID       |
| page   | int  | 否   | 页码，默认0  |
| size   | int  | 否   | 每页大小，默认10 |

**响应示例**：

```json
{
  "code": 200,
  "message": "获取岗位申请列表成功",
  "data": {
    "records": [
      {
        "id": 1,
        "jobId": 1,
        "studentId": 5,
        "status": "submitted",
        "appliedAt": "2025-06-27T14:30:00",
        "studentProfile": {
          "nickname": "张同学",
          "realName": "张三",
          "major": "计算机科学与技术",
          "educationLevel": "本科",
          "resumeUrl": "http://example.com/resumes/student1.pdf"
        }
      },
      // 更多申请...
    ],
    "total": 5,
    "size": 10,
    "current": 0,
    "pages": 1
  }
}
```

## 3. 错误码说明

| 错误码 | 说明                     |
| ------ | ------------------------ |
| 200    | 请求成功                 |
| 201    | 创建成功                 |
| 204    | 删除成功                 |
| 400    | 请求参数错误或业务逻辑错误 |
| 401    | 未认证                   |
| 403    | 权限不足                 |
| 404    | 资源不存在               |
| 500    | 服务器内部错误           |

## 4. 权限控制说明

1. **EN_ADMIN**和**EN_TEACHER**可以:
   - 创建岗位
   - 更新自己企业的岗位
   - 删除自己企业的岗位
   - 查看自己企业岗位的申请列表

2. **STUDENT**可以:
   - 申请岗位

3. **SYSADMIN**拥有所有权限

4. **公开接口**（无需登录即可访问）:
   - 查看岗位列表
   - 查看岗位详情 