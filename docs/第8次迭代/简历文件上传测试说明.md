# 简历文件上传API测试说明

本文档介绍如何使用Postman测试我们修改后的简历文件上传功能。

## 测试环境准备

1. 确保服务端已经启动
2. 准备一份PDF格式的简历文件用于上传测试（如果需要测试文件上传）

## 测试用例1：创建简历（基本信息）

### 请求信息

- **URL**: `http://localhost:8081/api/v1/me/resume`
- **方法**: POST
- **认证**: Bearer Token (使用有效的JWT令牌)
- **内容类型**: multipart/form-data 或 application/x-www-form-urlencoded

### 请求参数

在Postman中，选择"Body"选项卡，然后选择"form-data"或"x-www-form-urlencoded"，添加以下字段：

| Key | Value | 类型 | 是否必需 |
|-----|-------|------|----------|
| major | 计算机科学与技术 | Text | 是 |
| educationLevel | 本科 | Text | 是 |
| achievements | 校级奖学金三次，创新大赛一等奖 | Text | 否 |

### 预期响应

```json
{
  "code": 200,
  "message": "简历创建成功",
  "data": {
    "id": 1,
    "major": "计算机科学与技术",
    "educationLevel": "本科",
    "resumeUrl": null,
    "achievements": "校级奖学金三次，创新大赛一等奖"
  }
}
```

## 测试用例2：创建简历（含文件上传）

### 请求信息

- **URL**: `http://localhost:8081/api/v1/me/resume`
- **方法**: POST
- **认证**: Bearer Token (使用有效的JWT令牌)
- **内容类型**: multipart/form-data

### 请求参数

在Postman中，选择"Body"选项卡，然后选择"form-data"，添加以下字段：

| Key | Value | 类型 | 是否必需 |
|-----|-------|------|----------|
| major | 计算机科学与技术 | Text | 是 |
| educationLevel | 本科 | Text | 是 |
| achievements | 校级奖学金三次，创新大赛一等奖 | Text | 否 |
| file | [选择一个PDF文件] | File | 否 |

### 预期响应

```json
{
  "code": 200,
  "message": "简历创建成功",
  "data": {
    "id": 1,
    "major": "计算机科学与技术",
    "educationLevel": "本科",
    "resumeUrl": "http://localhost:8081/api/files/resume/xxxx.pdf",
    "achievements": "校级奖学金三次，创新大赛一等奖"
  }
}
```

## 测试用例3：更新简历（仅更新信息）

### 请求信息

- **URL**: `http://localhost:8081/api/v1/me/resume/{resumeId}`（将`{resumeId}`替换为实际的简历ID）
- **方法**: PUT
- **认证**: Bearer Token (使用有效的JWT令牌)
- **内容类型**: multipart/form-data 或 application/x-www-form-urlencoded

### 请求参数

在Postman中，选择"Body"选项卡，然后选择"form-data"或"x-www-form-urlencoded"，添加以下字段：

| Key | Value | 类型 | 是否必需 |
|-----|-------|------|----------|
| major | 软件工程 | Text | 否 |
| educationLevel | 硕士 | Text | 否 |
| achievements | 校级奖学金四次，省级比赛二等奖 | Text | 否 |

### 预期响应

```json
{
  "code": 200,
  "message": "简历更新成功",
  "data": {
    "id": 1,
    "major": "软件工程",
    "educationLevel": "硕士",
    "resumeUrl": "[保留原URL]",
    "achievements": "校级奖学金四次，省级比赛二等奖"
  }
}
```

## 测试用例4：更新简历（含文件上传）

### 请求信息

- **URL**: `http://localhost:8081/api/v1/me/resume/{resumeId}`（将`{resumeId}`替换为实际的简历ID）
- **方法**: PUT
- **认证**: Bearer Token (使用有效的JWT令牌)
- **内容类型**: multipart/form-data

### 请求参数

在Postman中，选择"Body"选项卡，然后选择"form-data"，添加以下字段：

| Key | Value | 类型 | 是否必需 |
|-----|-------|------|----------|
| major | 软件工程 | Text | 否 |
| educationLevel | 硕士 | Text | 否 |
| achievements | 校级奖学金四次，省级比赛二等奖 | Text | 否 |
| file | [选择一个PDF文件] | File | 否 |

### 预期响应

```json
{
  "code": 200,
  "message": "简历更新成功",
  "data": {
    "id": 1,
    "major": "软件工程",
    "educationLevel": "硕士",
    "resumeUrl": "http://localhost:8081/api/files/resume/yyyy.pdf",
    "achievements": "校级奖学金四次，省级比赛二等奖"
  }
}
```

## 常见问题与解决方案

### 问题1：发送请求时遇到415错误（Unsupported Media Type）

**解决方案**：
- 确保在Postman中选择了"form-data"或"x-www-form-urlencoded"而不是"raw"或其他选项
- 不要手动设置Content-Type请求头，让Postman自动设置
- 检查文件大小是否超过了服务器配置的限制（10MB）

### 问题2：认证失败（401 Unauthorized）

**解决方案**：
- 确保使用了有效的JWT令牌
- 检查令牌是否已过期
- 验证令牌格式是否正确（以"Bearer "开头，后跟实际的令牌）

### 问题3：找不到指定的简历（404 Not Found）

**解决方案**：
- 确认resumeId是否正确
- 验证当前登录用户是否为该简历的拥有者
- 检查该简历是否已被删除

### 问题4：缺少必需参数（400 Bad Request）

**解决方案**：
- 确保提供了必需的参数（major和educationLevel）
- 检查参数名称是否正确（区分大小写）
- 确保参数值不为空

## 测试结果记录

| 测试用例 | 测试时间 | 测试结果 | 备注 |
|---------|---------|----------|------|
| 创建简历（基本信息） | 2025-06-30 | 成功 | 无文件上传也可以成功创建 |
| 创建简历（含文件上传） | 2025-06-30 | 成功 | 需要确保form-data格式正确 |
| 更新简历（仅更新信息） | 2025-06-30 | 成功 | 不提供文件时保留原文件URL |
| 更新简历（含文件上传） | 2025-06-30 | 成功 | 上传的文件会替换原先的文件 |

## 注意事项

1. 请确保使用Postman最新版本，以支持multipart/form-data格式的文件上传
2. 每次测试前，请先清空Postman的缓存，以避免使用过期的JWT令牌
3. 对于大文件上传，可能需要增加请求超时时间
4. 创建简历时必须提供major和educationLevel字段，但文件和achievements字段是可选的
5. 更新简历时所有字段都是可选的，未提供的字段会保持原值不变 