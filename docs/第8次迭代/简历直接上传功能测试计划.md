# 简历直接上传功能测试计划

## 背景

我们对简历管理功能进行了增强，添加了直接上传简历文件的API接口。之前的设计要求用户先上传文件获取URL，然后再更新简历信息，这种两步操作降低了用户体验。现在我们提供了一步式API，用户可以在创建或更新简历时直接上传文件。

## 测试目标

1. 验证带文件上传的创建简历接口功能正常
2. 验证带文件上传的更新简历接口功能正常
3. 确认文件上传和简历信息更新的一致性
4. 测试边界情况和错误处理

## 测试环境

- 开发环境：本地开发服务器
- 数据库：MySQL 8.0
- API测试工具：Postman
- 文件存储：本地文件系统

## 测试用例

### 1. 创建简历（带文件上传）测试

#### 测试步骤
1. 用户登录系统获取JWT令牌
2. 使用POST `/api/v1/me/resume/upload`创建简历，同时上传PDF文件
3. 验证返回的简历信息
4. 验证文件是否成功上传且URL正确

#### 预期结果
- 请求应返回201状态码
- 返回的简历对象包含正确的文件URL和其他字段
- 文件应被正确上传到服务器，可以通过URL访问

#### Postman测试
```
// 1. 登录获取token
POST {{baseUrl}}/v1/auth/login
Content-Type: application/json

{
  "username": "testuser",
  "password": "password123"
}

// 2. 创建简历并上传文件
POST {{baseUrl}}/v1/me/resume/upload
Authorization: Bearer {{token}}
Content-Type: multipart/form-data

major: 计算机科学与技术
educationLevel: 本科
achievements: 获得校级奖学金
file: [选择PDF文件]

// 3. 验证简历创建成功
GET {{baseUrl}}/v1/me/resumes
Authorization: Bearer {{token}}
```

### 2. 更新简历（带文件上传）测试

#### 测试步骤
1. 用户登录系统获取JWT令牌
2. 获取用户的简历列表，记录要更新的简历ID
3. 使用PUT `/api/v1/me/resume/{resumeId}/upload`更新简历，同时上传新的PDF文件
4. 验证返回的简历信息
5. 验证文件是否成功上传且URL已更新

#### 预期结果
- 请求应返回200状态码
- 返回的简历对象应包含更新后的信息
- 文件应被正确上传到服务器，可以通过URL访问

#### Postman测试
```
// 1. 登录获取token (同上)

// 2. 获取简历列表并记录ID
GET {{baseUrl}}/v1/me/resumes
Authorization: Bearer {{token}}

// 3. 更新简历并上传文件
PUT {{baseUrl}}/v1/me/resume/{{resumeId}}/upload
Authorization: Bearer {{token}}
Content-Type: multipart/form-data

major: 软件工程
educationLevel: 硕士
achievements: 发表学术论文两篇
file: [选择PDF文件]

// 4. 验证简历更新成功
GET {{baseUrl}}/v1/resumes/{{resumeId}}
Authorization: Bearer {{token}}
```

### 3. 边界条件和错误处理测试

#### 3.1 文件类型限制测试

#### 测试步骤
1. 尝试上传非PDF文件（如图片、文本文件）

#### 预期结果
- 系统应返回400错误，提示不支持的文件类型

#### 3.2 文件大小限制测试

#### 测试步骤
1. 尝试上传超过10MB的文件

#### 预期结果
- 系统应返回400错误，提示文件大小超出限制

#### 3.3 必填字段缺失测试

#### 测试步骤
1. 不提供必填字段（major或educationLevel）

#### 预期结果
- 系统应返回400错误，指出缺少必填字段

#### 3.4 未授权访问测试

#### 测试步骤
1. 不提供令牌或提供无效令牌

#### 预期结果
- 系统应返回401错误，表示未授权

## 性能测试

### 1. 并发上传测试

#### 测试步骤
1. 模拟10个并发用户同时上传简历文件
2. 记录响应时间和成功率

#### 预期结果
- 所有请求应成功完成
- 平均响应时间应在可接受范围内（例如<3秒）

## 集成测试

### 1. 岗位申请关联测试

#### 测试步骤
1. 使用直接上传API创建简历
2. 使用该简历申请岗位
3. 验证岗位申请是否包含正确的简历引用

#### 预期结果
- 岗位申请应成功创建
- 申请中的简历ID和URL应与上传时创建的简历一致

## 回归测试

除了上述特定测试外，还应进行以下回归测试，确保现有功能不受影响：

1. 原有的分步式API（先上传文件，后创建/更新简历）仍然可用
2. 简历列表和详情查询功能正常
3. 删除简历功能正常

## 责任人

- 测试执行：[测试人员姓名]
- 测试监督：[项目经理姓名]

## 测试时间安排

- 测试开始日期：[日期]
- 测试结束日期：[日期]
- 测试报告提交日期：[日期] 