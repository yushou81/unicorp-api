# 第七次迭代测试计划

## 测试目标

本次迭代的测试目标是验证岗位收藏功能的正确性和可靠性，包括：

1. 学生用户收藏岗位功能
2. 学生用户取消收藏岗位功能
3. 学生用户查看已收藏岗位列表功能
4. 权限控制（仅学生用户可以使用收藏功能）

## 测试环境

- 操作系统：Windows 10/11, macOS, Linux
- 浏览器：Chrome 最新版, Firefox 最新版, Safari 最新版
- 后端服务器：Spring Boot 应用部署在本地开发环境
- 数据库：MySQL 8.0

## 测试工具

- Postman：API 测试
- JUnit：单元测试
- MySQL Workbench：数据库查询和验证

## 测试用例

### 1. 获取收藏岗位列表功能测试

**接口**：GET /api/v1/me/favorites/jobs

**测试步骤**：
1. 使用有效的学生用户凭据获取JWT令牌
2. 在请求头中设置Authorization: Bearer {token}
3. 发送GET请求到 `/api/v1/me/favorites/jobs`，可选添加分页参数
4. 验证返回状态码为200
5. 验证返回的JSON数据包含收藏的岗位列表

**预期结果**：
- 返回状态码为200
- 返回的JSON数据包含收藏的岗位列表
- 如果使用非学生用户，应返回403错误

**Postman测试**：
1. 首先使用学生用户登录API获取JWT令牌
2. 创建新的GET请求
3. 设置URL为 `http://localhost:8081/api/v1/me/favorites/jobs?page=0&size=10`
4. 添加请求头 `Authorization: Bearer {token}`
5. 发送请求并验证响应

### 2. 收藏岗位功能测试

**接口**：POST /api/v1/jobs/{id}/favorite

**测试步骤**：
1. 使用有效的学生用户凭据获取JWT令牌
2. 在请求头中设置Authorization: Bearer {token}
3. 发送POST请求到 `/api/v1/jobs/{id}/favorite`，其中 `{id}` 替换为实际岗位ID
4. 验证返回状态码为201
5. 验证岗位已添加到用户的收藏列表中

**预期结果**：
- 返回状态码为201
- 数据库中已添加收藏记录
- 如果岗位不存在，应返回404错误
- 如果已收藏过该岗位，应返回400错误
- 如果使用非学生用户，应返回403错误

**Postman测试**：
1. 首先使用学生用户登录API获取JWT令牌
2. 创建新的POST请求
3. 设置URL为 `http://localhost:8081/api/v1/jobs/{id}/favorite`
4. 添加请求头 `Authorization: Bearer {token}`
5. 发送请求并验证响应
6. 再次发送相同请求，验证返回400错误（已收藏过该岗位）

### 3. 取消收藏岗位功能测试

**接口**：DELETE /api/v1/jobs/{id}/favorite

**测试步骤**：
1. 使用有效的学生用户凭据获取JWT令牌
2. 在请求头中设置Authorization: Bearer {token}
3. 发送DELETE请求到 `/api/v1/jobs/{id}/favorite`，其中 `{id}` 替换为实际岗位ID
4. 验证返回状态码为204
5. 验证岗位已从用户的收藏列表中移除

**预期结果**：
- 返回状态码为204（无内容）
- 数据库中的收藏记录已被删除
- 如果使用非学生用户，应返回403错误

**Postman测试**：
1. 首先使用学生用户登录API获取JWT令牌
2. 创建新的DELETE请求
3. 设置URL为 `http://localhost:8081/api/v1/jobs/{id}/favorite`
4. 添加请求头 `Authorization: Bearer {token}`
5. 发送请求并验证响应
6. 调用获取收藏岗位列表API，验证该岗位已不在列表中

### 4. 权限控制测试

**测试步骤**：
1. 使用非学生用户（如企业管理员、教师等）凭据获取JWT令牌
2. 尝试调用收藏相关的API
3. 验证返回状态码为403

**预期结果**：
- 返回状态码为403
- 返回的JSON数据包含权限不足的错误信息

**Postman测试**：
1. 使用非学生用户登录API获取JWT令牌
2. 创建请求调用收藏相关的API
3. 添加请求头 `Authorization: Bearer {token}`
4. 发送请求并验证响应状态码为403

## 测试数据准备

为了进行有效的测试，需要准备以下测试数据：

1. 不同角色的用户账号（学生、教师、企业管理员等）
2. 多个招聘岗位记录
3. 一些预先创建的收藏记录

## 测试结果记录

测试执行后，应记录以下信息：

1. 测试用例ID
2. 测试日期和时间
3. 测试人员
4. 测试结果（通过/失败）
5. 如果失败，记录失败原因和错误信息
6. 测试环境信息

## 回归测试

在修复任何问题后，应进行回归测试以确保：

1. 修复的问题已经解决
2. 修复没有引入新的问题
3. 相关功能仍然正常工作

## 验收标准

本次迭代的验收标准为：

1. 所有API端点按照规范工作
2. 学生用户可以成功收藏和取消收藏岗位
3. 学生用户可以查看自己收藏的岗位列表
4. 非学生用户无法使用收藏功能
5. 所有错误情况都有适当的处理和响应 