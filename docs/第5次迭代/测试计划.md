# 第五次迭代测试计划

## 测试目标

本次迭代的测试目标是验证以下功能的正确性和可靠性：

1. 用户个人主页的展示与编辑功能
2. 学生作品集管理功能

## 测试环境

- 操作系统：Windows 10/11, macOS, Linux
- 浏览器：Chrome 最新版, Firefox 最新版, Safari 最新版
- 后端服务器：Spring Boot 应用部署在本地开发环境
- 数据库：MySQL 8.0

## 测试工具

- Postman：API 测试
- JUnit：单元测试
- MySQL Workbench：数据库查询和验证

## 测试用例

### 1. 个人主页功能测试

#### 1.1 获取指定用户的公开主页信息

**接口**：GET /api/v1/profiles/{userId}

**测试步骤**：
1. 准备测试数据，确保数据库中存在至少一个用户
2. 发送GET请求到 `/api/v1/profiles/{userId}`，其中 `{userId}` 替换为实际用户ID
3. 验证返回状态码为200
4. 验证返回的JSON数据包含正确的用户信息

**预期结果**：
- 返回状态码为200
- 返回的JSON数据包含用户的基本信息（ID、账号、昵称、头像URL、简介、组织名称、角色列表）
- 如果是学生用户，还应包含学生档案信息和作品集列表

**Postman测试**：
1. 创建新的GET请求
2. 设置URL为 `http://localhost:8081/api/v1/profiles/{userId}`
3. 发送请求并验证响应

#### 1.2 获取当前登录用户的详细档案信息

**接口**：GET /api/v1/me/profile

**测试步骤**：
1. 使用有效的用户凭据获取JWT令牌
2. 在请求头中设置Authorization: Bearer {token}
3. 发送GET请求到 `/api/v1/me/profile`
4. 验证返回状态码为200
5. 验证返回的JSON数据包含当前用户的完整档案信息

**预期结果**：
- 返回状态码为200
- 返回的JSON数据包含用户的完整档案信息
- 如果是学生用户，还应包含学生档案信息和作品集列表

**Postman测试**：
1. 首先使用登录API获取JWT令牌
2. 创建新的GET请求
3. 设置URL为 `http://localhost:8081/api/v1/me/profile`
4. 添加请求头 `Authorization: Bearer {token}`
5. 发送请求并验证响应

#### 1.3 更新当前登录用户的基本档案

**接口**：PUT /api/v1/me/profile

**测试步骤**：
1. 使用有效的用户凭据获取JWT令牌
2. 在请求头中设置Authorization: Bearer {token}
3. 准备请求体，包含要更新的用户信息（昵称、简介、头像URL）
4. 发送PUT请求到 `/api/v1/me/profile`
5. 验证返回状态码为200
6. 验证返回的JSON数据包含更新后的用户信息

**预期结果**：
- 返回状态码为200
- 返回的JSON数据包含更新后的用户信息
- 数据库中的用户信息已更新

**Postman测试**：
1. 首先使用登录API获取JWT令牌
2. 创建新的PUT请求
3. 设置URL为 `http://localhost:8081/api/v1/me/profile`
4. 添加请求头 `Authorization: Bearer {token}`
5. 设置请求体为JSON格式：
   ```json
   {
     "nickname": "新昵称",
     "bio": "这是我的个人简介",
     "avatarUrl": "https://example.com/avatar.jpg"
   }
   ```
6. 发送请求并验证响应

### 2. 学生作品集管理功能测试

#### 2.1 获取我的作品集列表

**接口**：GET /api/v1/me/portfolio

**测试步骤**：
1. 使用有效的学生用户凭据获取JWT令牌
2. 在请求头中设置Authorization: Bearer {token}
3. 发送GET请求到 `/api/v1/me/portfolio`
4. 验证返回状态码为200
5. 验证返回的JSON数据包含作品集列表

**预期结果**：
- 返回状态码为200
- 返回的JSON数据包含作品集列表
- 如果使用非学生用户，应返回403错误

**Postman测试**：
1. 首先使用学生用户登录API获取JWT令牌
2. 创建新的GET请求
3. 设置URL为 `http://localhost:8081/api/v1/me/portfolio`
4. 添加请求头 `Authorization: Bearer {token}`
5. 发送请求并验证响应

#### 2.2 添加新的作品集项目

**接口**：POST /api/v1/me/portfolio

**测试步骤**：
1. 使用有效的学生用户凭据获取JWT令牌
2. 在请求头中设置Authorization: Bearer {token}
3. 准备请求体，包含新作品集项目的信息
4. 发送POST请求到 `/api/v1/me/portfolio`
5. 验证返回状态码为201
6. 验证返回的JSON数据包含新创建的作品集项目信息

**预期结果**：
- 返回状态码为201
- 返回的JSON数据包含新创建的作品集项目信息
- 数据库中已添加新的作品集项目记录
- 如果使用非学生用户，应返回403错误

**Postman测试**：
1. 首先使用学生用户登录API获取JWT令牌
2. 创建新的POST请求
3. 设置URL为 `http://localhost:8081/api/v1/me/portfolio`
4. 添加请求头 `Authorization: Bearer {token}`
5. 设置请求体为JSON格式：
   ```json
   {
     "title": "我的项目",
     "description": "这是我的项目描述",
     "projectUrl": "https://github.com/username/project",
     "coverImageUrl": "https://example.com/cover.jpg"
   }
   ```
6. 发送请求并验证响应

#### 2.3 更新作品集项目

**接口**：PUT /api/v1/me/portfolio/{itemId}

**测试步骤**：
1. 使用有效的学生用户凭据获取JWT令牌
2. 在请求头中设置Authorization: Bearer {token}
3. 准备请求体，包含要更新的作品集项目信息
4. 发送PUT请求到 `/api/v1/me/portfolio/{itemId}`，其中 `{itemId}` 替换为实际项目ID
5. 验证返回状态码为200
6. 验证返回的JSON数据包含更新后的作品集项目信息

**预期结果**：
- 返回状态码为200
- 返回的JSON数据包含更新后的作品集项目信息
- 数据库中的作品集项目记录已更新
- 如果使用非学生用户，应返回403错误
- 如果项目不存在，应返回404错误
- 如果尝试更新不属于当前用户的项目，应返回403错误

**Postman测试**：
1. 首先使用学生用户登录API获取JWT令牌
2. 创建新的PUT请求
3. 设置URL为 `http://localhost:8081/api/v1/me/portfolio/{itemId}`
4. 添加请求头 `Authorization: Bearer {token}`
5. 设置请求体为JSON格式：
   ```json
   {
     "title": "更新后的项目标题",
     "description": "更新后的项目描述",
     "projectUrl": "https://github.com/username/updated-project",
     "coverImageUrl": "https://example.com/updated-cover.jpg"
   }
   ```
6. 发送请求并验证响应

#### 2.4 删除作品集项目

**接口**：DELETE /api/v1/me/portfolio/{itemId}

**测试步骤**：
1. 使用有效的学生用户凭据获取JWT令牌
2. 在请求头中设置Authorization: Bearer {token}
3. 发送DELETE请求到 `/api/v1/me/portfolio/{itemId}`，其中 `{itemId}` 替换为实际项目ID
4. 验证返回状态码为204

**预期结果**：
- 返回状态码为204（无内容）
- 数据库中的作品集项目记录已被逻辑删除
- 如果使用非学生用户，应返回403错误
- 如果尝试删除不属于当前用户的项目，应返回403错误

**Postman测试**：
1. 首先使用学生用户登录API获取JWT令牌
2. 创建新的DELETE请求
3. 设置URL为 `http://localhost:8081/api/v1/me/portfolio/{itemId}`
4. 添加请求头 `Authorization: Bearer {token}`
5. 发送请求并验证响应

## 测试数据准备

为了进行有效的测试，需要准备以下测试数据：

1. 不同角色的用户账号（学生、教师、企业导师等）
2. 学生用户的档案信息
3. 学生用户的作品集项目

## 测试结果记录

测试执行后，应记录以下信息：

1. 测试用例ID
2. 测试日期和时间
3. 测试人员
4. 测试结果（通过/失败）
5. 如果失败，记录失败原因和错误信息
6. 测试环境信息

## 回归测试

在修复任何问题后，应进行回归测试以确保：

1. 修复的问题已经解决
2. 修复没有引入新的问题
3. 相关功能仍然正常工作

## 验收标准

本次迭代的验收标准为：

1. 所有API端点按照规范工作
2. 用户个人主页信息可以正确展示和编辑
3. 学生用户可以成功管理自己的作品集
4. 所有安全限制正确实施（如角色权限控制）
5. 所有错误情况都有适当的处理和响应 