# 双师课堂接口文档

本文档基于OpenAPI 3.0规范，描述校企联盟平台的双师课堂相关接口。

```yaml
openapi: 3.0.3
info:
  title: 校企联盟平台 - 双师课堂API
  description: 双师课堂功能接口，提供课程创建、查询、报名等功能
  version: 1.0.0
  
servers:
  - url: http://localhost:8081/api
    description: 本地开发环境
  - url: https://api.unicorp.example.com
    description: 生产环境
    
tags:
  - name: 双师课堂
    description: 双师课堂相关操作
  - name: 课程评价
    description: 课程评价相关操作
  - name: 课程资源
    description: 课程资源相关操作
  - name: 课程章节
    description: 课程章节管理
  - name: 学习进度
    description: 学习进度管理
  - name: 课程讨论
    description: 课程讨论功能
  - name: 课程问答
    description: 课程问答功能
  - name: 课程出勤
    description: 课程出勤管理
    
paths:
  /v1/dual-courses:
    post:
      tags:
        - 双师课堂
      summary: 创建双师课堂课程
      description: 创建新的双师课堂课程，需要教师或学校管理员权限
      operationId: createCourse
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DualTeacherCourseDTO'
      responses:
        '200':
          description: 课程创建成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DualTeacherCourseResponse'
        '400':
          description: 参数错误或权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    
  /v1/dual-courses/{id}:
    get:
      tags:
        - 双师课堂
      summary: 获取双师课堂课程详情
      description: 根据ID获取课程详细信息
      operationId: getCourseById
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: 获取课程详情成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DualTeacherCourseResponse'
        '404':
          description: 课程不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    
    put:
      tags:
        - 双师课堂
      summary: 更新双师课堂课程信息
      description: 更新现有双师课堂课程的信息，需要该课程的教师、企业导师或学校管理员权限
      operationId: updateCourse
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int32
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DualTeacherCourseDTO'
      responses:
        '200':
          description: 课程更新成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DualTeacherCourseResponse'
        '400':
          description: 参数错误或权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: 课程不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    
    delete:
      tags:
        - 双师课堂
      summary: 删除双师课堂课程
      description: 删除指定的双师课堂课程，需要该课程的教师或学校管理员权限
      operationId: deleteCourse
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: 课程删除成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: 课程不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  
  /v1/dual-courses/{id}/status:
    patch:
      tags:
        - 双师课堂
      summary: 更新课程状态
      description: 更新双师课堂课程的状态，需要该课程的教师或学校管理员权限
      operationId: updateCourseStatus
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int32
        - name: status
          in: query
          required: true
          description: 新状态值
          schema:
            type: string
            enum: [planning, open, in_progress, completed, cancelled]
      responses:
        '200':
          description: 状态更新成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DualTeacherCourseResponse'
        '400':
          description: 参数错误或权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: 课程不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  
  /v1/dual-courses/teacher:
    get:
      tags:
        - 双师课堂
      summary: 获取教师创建的课程列表
      description: 获取当前教师用户创建的所有课程
      operationId: getTeacherCourses
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          description: 页码，从1开始
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: size
          in: query
          description: 每页大小
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
      responses:
        '200':
          description: 获取课程列表成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PagedDualTeacherCourseResponse'
        '400':
          description: 用户不是教师
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  
  /v1/dual-courses/mentor:
    get:
      tags:
        - 双师课堂
      summary: 获取企业导师参与的课程列表
      description: 获取当前企业导师用户参与的所有课程
      operationId: getMentorCourses
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          description: 页码，从1开始
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: size
          in: query
          description: 每页大小
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
      responses:
        '200':
          description: 获取课程列表成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PagedDualTeacherCourseResponse'
        '400':
          description: 用户不是企业导师
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  
  /v1/dual-courses/enrollable:
    get:
      tags:
        - 双师课堂
      summary: 获取可报名的课程列表
      description: 获取当前可供学生报名的所有课程
      operationId: getEnrollableCourses
      parameters:
        - name: page
          in: query
          description: 页码，从1开始
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: size
          in: query
          description: 每页大小
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
      responses:
        '200':
          description: 获取课程列表成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PagedDualTeacherCourseResponse'
  
  /v1/dual-courses/enroll:
    post:
      tags:
        - 双师课堂
      summary: 学生报名课程
      description: 学生用户报名双师课堂课程
      operationId: enrollCourse
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CourseEnrollmentDTO'
      responses:
        '200':
          description: 报名成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: 报名失败，可能的原因：用户不是学生、课程不存在、课程未开放报名、已报名该课程、课程人数已满
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  
  /v1/dual-courses/enroll/{courseId}:
    delete:
      tags:
        - 双师课堂
      summary: 学生取消报名
      description: 学生用户取消已报名的课程
      operationId: cancelEnrollment
      security:
        - bearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: 取消报名成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: 取消报名失败，可能的原因：用户未报名该课程、课程已开始或已结束
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  
  /v1/dual-courses/enrolled:
    get:
      tags:
        - 双师课堂
      summary: 获取学生已报名的课程列表
      description: 获取当前学生用户已报名的所有课程
      operationId: getStudentEnrolledCourses
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          description: 页码，从1开始
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: size
          in: query
          description: 每页大小
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
      responses:
        '200':
          description: 获取课程列表成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PagedDualTeacherCourseResponse'
        '400':
          description: 用户不是学生
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/dual-courses/enrollment/{enrollmentId}/status:
    patch:
      tags:
        - 双师课堂
      summary: 更新学生选课状态
      description: 更新学生选课状态，需要课程教师或学校管理员权限
      operationId: updateEnrollmentStatus
      security:
        - bearerAuth: []
      parameters:
        - name: enrollmentId
          in: path
          required: true
          schema:
            type: integer
            format: int32
        - name: status
          in: query
          required: true
          description: 新状态值
          schema:
            type: string
            enum: [enrolled, cancelled, completed]
      responses:
        '200':
          description: 选课状态更新成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: 参数错误或权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: 选课记录不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # 课程评价相关接口
  /v1/course-ratings:
    post:
      tags:
        - 课程评价
      summary: 提交课程评价
      description: 学生提交对已完成课程的评价
      operationId: submitRating
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CourseRatingDTO'
      responses:
        '200':
          description: 评价提交成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CourseRatingResponse'
        '400':
          description: 参数错误或权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  
  /v1/course-ratings/{ratingId}:
    get:
      tags:
        - 课程评价
      summary: 获取课程评价详情
      description: 根据ID获取课程评价详细信息
      operationId: getRatingById
      parameters:
        - name: ratingId
          in: path
          required: true
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: 获取评价详情成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CourseRatingResponse'
        '404':
          description: 评价不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    
    put:
      tags:
        - 课程评价
      summary: 更新课程评价
      description: 学生更新已提交的课程评价
      operationId: updateRating
      security:
        - bearerAuth: []
      parameters:
        - name: ratingId
          in: path
          required: true
          schema:
            type: integer
            format: int32
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CourseRatingDTO'
      responses:
        '200':
          description: 评价更新成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CourseRatingResponse'
        '400':
          description: 参数错误或权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: 评价不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    
    delete:
      tags:
        - 课程评价
      summary: 删除课程评价
      description: 学生删除已提交的课程评价
      operationId: deleteRating
      security:
        - bearerAuth: []
      parameters:
        - name: ratingId
          in: path
          required: true
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: 评价删除成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: 评价不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  
  /v1/course-ratings/course/{courseId}:
    get:
      tags:
        - 课程评价
      summary: 获取课程评价列表
      description: 获取指定课程的所有评价
      operationId: getRatingsByCourseId
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: integer
            format: int32
        - name: page
          in: query
          description: 页码，从1开始
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: size
          in: query
          description: 每页大小
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
      responses:
        '200':
          description: 获取评价列表成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PagedCourseRatingResponse'
        '404':
          description: 课程不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  
  /v1/course-ratings/average/{courseId}:
    get:
      tags:
        - 课程评价
      summary: 获取课程平均评分
      description: 获取指定课程的平均评分
      operationId: getAverageRating
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: 获取平均评分成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AverageRatingResponse'
        '404':
          description: 课程不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  
  /v1/course-ratings/check/{courseId}:
    get:
      tags:
        - 课程评价
      summary: 检查学生是否已评价课程
      description: 检查当前学生是否已对指定课程进行评价
      operationId: hasRated
      security:
        - bearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: 检查成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HasRatedResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # 课程资源相关接口
  /v1/course-resources:
    post:
      tags:
        - 课程资源
      summary: 上传课程资源
      description: 上传课程资源文件，需要教师或企业导师权限
      operationId: uploadResource
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: 资源文件
                courseId:
                  type: integer
                  format: int32
                  description: 课程ID
                title:
                  type: string
                  description: 资源标题
                description:
                  type: string
                  description: 资源描述
                resourceType:
                  type: string
                  description: 资源类型(document, video, code, other)
      responses:
        '200':
          description: 资源上传成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CourseResourceResponse'
        '400':
          description: 参数错误或权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  
  /v1/course-resources/{resourceId}:
    get:
      tags:
        - 课程资源
      summary: 获取课程资源详情
      description: 根据ID获取课程资源详细信息
      operationId: getResourceById
      parameters:
        - name: resourceId
          in: path
          required: true
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: 获取资源详情成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CourseResourceResponse'
        '404':
          description: 资源不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    
    delete:
      tags:
        - 课程资源
      summary: 删除课程资源
      description: 删除指定的课程资源，需要资源上传者或教师权限
      operationId: deleteResource
      security:
        - bearerAuth: []
      parameters:
        - name: resourceId
          in: path
          required: true
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: 资源删除成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: 资源不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  
  /v1/course-resources/course/{courseId}:
    get:
      tags:
        - 课程资源
      summary: 获取课程资源列表
      description: 获取指定课程的所有资源
      operationId: getResourcesByCourseId
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: integer
            format: int32
        - name: page
          in: query
          description: 页码，从1开始
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: size
          in: query
          description: 每页大小
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
      responses:
        '200':
          description: 获取资源列表成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PagedCourseResourceResponse'
        '404':
          description: 课程不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  
  /v1/course-resources/download/{resourceId}:
    get:
      tags:
        - 课程资源
      summary: 下载课程资源
      description: 下载指定的课程资源文件
      operationId: downloadResource
      parameters:
        - name: resourceId
          in: path
          required: true
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: 文件下载成功
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
        '404':
          description: 资源不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # 获取课程学生列表
  /v1/dual-courses/{id}/students:
    get:
      tags:
        - 双师课堂
      summary: 获取课程学生列表
      description: 获取指定课程ID的已报名学生列表，需要教师或管理员权限
      operationId: getCourseStudents
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: 课程ID
          required: true
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: 获取学生列表成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  message:
                    type: string
                    example: 获取课程学生列表成功
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/UserVO'
        '400':
          description: 权限不足或课程不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'

  # 课程章节相关接口
  /v1/course-chapters:
    post:
      tags:
        - 课程章节
      summary: 创建课程章节
      description: 为指定课程创建新的章节，需要教师或管理员权限
      operationId: createChapter
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CourseChapterDTO'
      responses:
        '200':
          description: 创建成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '400':
          description: 参数错误
        '403':
          description: 无权限
          
  /v1/course-chapters/{id}:
    put:
      tags:
        - 课程章节
      summary: 更新课程章节
      description: 更新指定ID的章节信息，需要教师或管理员权限
      operationId: updateChapter
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: 章节ID
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CourseChapterDTO'
      responses:
        '200':
          description: 更新成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '400':
          description: 参数错误
        '403':
          description: 无权限
        '404':
          description: 章节不存在
          
    get:
      tags:
        - 课程章节
      summary: 获取章节详情
      description: 获取指定ID章节的详细信息
      operationId: getChapterDetail
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: 章节ID
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 获取成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '404':
          description: 章节不存在
          
    delete:
      tags:
        - 课程章节
      summary: 删除课程章节
      description: 删除指定ID的章节，需要教师或管理员权限
      operationId: deleteChapter
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: 章节ID
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 删除成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '403':
          description: 无权限
        '404':
          description: 章节不存在
          
  /v1/course-chapters/course/{courseId}:
    get:
      tags:
        - 课程章节
      summary: 获取课程章节列表
      description: 获取指定课程的所有章节列表
      operationId: getChaptersByCourse
      security:
        - bearerAuth: []
      parameters:
        - name: courseId
          in: path
          description: 课程ID
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 获取成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '404':
          description: 课程不存在
          
  /v1/course-chapters/{id}/publish:
    put:
      tags:
        - 课程章节
      summary: 更新章节发布状态
      description: 更新指定章节的发布状态，需要教师或管理员权限
      operationId: updatePublishStatus
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: 章节ID
          required: true
          schema:
            type: integer
        - name: isPublished
          in: query
          description: 是否发布
          required: true
          schema:
            type: boolean
      responses:
        '200':
          description: 更新成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '403':
          description: 无权限
        '404':
          description: 章节不存在
          
  /v1/course-chapters/{id}/sequence:
    put:
      tags:
        - 课程章节
      summary: 更新章节顺序
      description: 更新指定章节的顺序，需要教师或管理员权限
      operationId: updateSequence
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: 章节ID
          required: true
          schema:
            type: integer
        - name: sequence
          in: query
          description: 顺序
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 更新成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '403':
          description: 无权限
        '404':
          description: 章节不存在
          
  /v1/course-chapters/{id}/resources/{resourceId}:
    post:
      tags:
        - 课程章节
      summary: 关联资源到章节
      description: 将指定资源关联到章节中，需要教师或管理员权限
      operationId: associateResource
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: 章节ID
          required: true
          schema:
            type: integer
        - name: resourceId
          in: path
          description: 资源ID
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 关联成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '403':
          description: 无权限
        '404':
          description: 章节或资源不存在
          
    delete:
      tags:
        - 课程章节
      summary: 从章节中移除资源
      description: 将指定资源从章节中移除，需要教师或管理员权限
      operationId: removeResource
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: 章节ID
          required: true
          schema:
            type: integer
        - name: resourceId
          in: path
          description: 资源ID
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 移除成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '403':
          description: 无权限
        '404':
          description: 章节或资源不存在
          
  /v1/course-chapters/{id}/resources:
    get:
      tags:
        - 课程章节
      summary: 获取章节关联的资源列表
      description: 获取指定章节关联的所有资源ID列表
      operationId: getChapterResources
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          description: 章节ID
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 获取成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '404':
          description: 章节不存在
          
  # 学习进度相关接口
  /v1/learning-progress:
    put:
      tags:
        - 学习进度
      summary: 更新学习进度
      description: 更新学生在章节中的学习进度
      operationId: updateProgress
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LearningProgressDTO'
      responses:
        '200':
          description: 更新成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '400':
          description: 参数错误
        '404':
          description: 章节不存在
          
  /v1/learning-progress/chapter/{chapterId}/student/{studentId}:
    get:
      tags:
        - 学习进度
      summary: 获取学生章节进度
      description: 获取指定学生在特定章节中的学习进度
      operationId: getStudentProgressInChapter
      security:
        - bearerAuth: []
      parameters:
        - name: chapterId
          in: path
          description: 章节ID
          required: true
          schema:
            type: integer
        - name: studentId
          in: path
          description: 学生ID
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 获取成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '404':
          description: 章节或学生不存在
          
  /v1/learning-progress/course/{courseId}/student/{studentId}:
    get:
      tags:
        - 学习进度
      summary: 获取学生课程进度
      description: 获取指定学生在整个课程中的学习进度
      operationId: getStudentProgressInCourse
      security:
        - bearerAuth: []
      parameters:
        - name: courseId
          in: path
          description: 课程ID
          required: true
          schema:
            type: integer
        - name: studentId
          in: path
          description: 学生ID
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 获取成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '404':
          description: 课程或学生不存在
          
  /v1/learning-progress/chapter/{chapterId}/students:
    get:
      tags:
        - 学习进度
      summary: 获取章节所有学生进度
      description: 获取特定章节中所有学生的学习进度
      operationId: getChapterStudentProgress
      security:
        - bearerAuth: []
      parameters:
        - name: chapterId
          in: path
          description: 章节ID
          required: true
          schema:
            type: integer
        - name: page
          in: query
          description: 页码
          schema:
            type: integer
            default: 1
        - name: size
          in: query
          description: 每页数量
          schema:
            type: integer
            default: 10
      responses:
        '200':
          description: 获取成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '404':
          description: 章节不存在
          
  /v1/learning-progress/course/{courseId}/overview:
    get:
      tags:
        - 学习进度
      summary: 获取课程进度概览
      description: 获取课程的整体学习进度概览
      operationId: getCourseProgressOverview
      security:
        - bearerAuth: []
      parameters:
        - name: courseId
          in: path
          description: 课程ID
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 获取成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '404':
          description: 课程不存在
          
  /v1/learning-progress/course/{courseId}/student/{studentId}/completion-rate:
    get:
      tags:
        - 学习进度
      summary: 获取学生课程完成率
      description: 获取指定学生在课程中的完成率
      operationId: getCourseCompletionRate
      security:
        - bearerAuth: []
      parameters:
        - name: courseId
          in: path
          description: 课程ID
          required: true
          schema:
            type: integer
        - name: studentId
          in: path
          description: 学生ID
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 获取成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '404':
          description: 课程或学生不存在
          
  /v1/learning-progress/chapter/{chapterId}/initialize:
    post:
      tags:
        - 学习进度
      summary: 初始化章节学习进度
      description: 为新章节初始化所有已报名学生的学习进度记录
      operationId: initializeChapterProgress
      security:
        - bearerAuth: []
      parameters:
        - name: chapterId
          in: path
          description: 章节ID
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: 初始化成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultVO'
        '403':
          description: 无权限
        '404':
          description: 章节不存在

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    DualTeacherCourseDTO:
      type: object
      required:
        - title
        - description
        - scheduledTime
        - courseType
      properties:
        title:
          type: string
          description: 课程标题
          minLength: 2
          maxLength: 50
          example: "Java企业级开发实战"
        description:
          type: string
          description: 课程描述
          maxLength: 500
          example: "本课程由学校教师与企业资深工程师共同授课，讲解Java企业级开发实战知识"
        teacherId:
          type: integer
          format: int32
          description: 教师ID
          example: 5
        mentorId:
          type: integer
          format: int32
          description: 企业导师ID
          example: 12
        scheduledTime:
          type: string
          format: date-time
          description: 课程计划时间
          example: "2024-12-10T14:00:00"
        maxStudents:
          type: integer
          format: int32
          description: 最大学生人数
          minimum: 1
          default: 50
          example: 30
        location:
          type: string
          description: 课程地点
          example: "计算机学院302教室"
        courseType:
          type: string
          description: 课程类型
          enum: [online, offline, hybrid]
          example: "hybrid"
    
    CourseEnrollmentDTO:
      type: object
      required:
        - courseId
      properties:
        courseId:
          type: integer
          format: int32
          description: 课程ID
          example: 1
    
    DualTeacherCourseVO:
      type: object
      properties:
        id:
          type: integer
          format: int32
          description: 课程ID
          example: 1
        title:
          type: string
          description: 课程标题
          example: "Java企业级开发实战"
        description:
          type: string
          description: 课程描述
          example: "本课程由学校教师与企业资深工程师共同授课，讲解Java企业级开发实战知识"
        teacherId:
          type: integer
          format: int32
          description: 教师ID
          example: 5
        teacherName:
          type: string
          description: 教师姓名
          example: "张三"
        mentorId:
          type: integer
          format: int32
          description: 企业导师ID
          example: 12
        mentorName:
          type: string
          description: 企业导师姓名
          example: "李四"
        enterpriseName:
          type: string
          description: 企业名称
          example: "阿里巴巴"
        scheduledTime:
          type: string
          format: date-time
          description: 课程计划时间
          example: "2024-12-10T14:00:00"
        maxStudents:
          type: integer
          format: int32
          description: 最大学生人数
          example: 30
        enrolledCount:
          type: integer
          format: int32
          description: 已报名学生人数
          example: 15
        location:
          type: string
          description: 课程地点
          example: "计算机学院302教室"
        courseType:
          type: string
          description: 课程类型
          enum: [online, offline, hybrid]
          example: "hybrid"
        status:
          type: string
          description: 课程状态
          enum: [planning, open, in_progress, completed, cancelled]
          example: "open"
        createdAt:
          type: string
          format: date-time
          description: 创建时间
          example: "2024-06-01T10:15:30"
    
    DualTeacherCourseResponse:
      type: object
      properties:
        code:
          type: integer
          description: 业务状态码
          example: 200
        message:
          type: string
          description: 响应信息
          example: "获取课程详情成功"
        data:
          $ref: '#/components/schemas/DualTeacherCourseVO'
    
    PagedDualTeacherCourseResponse:
      type: object
      properties:
        code:
          type: integer
          description: 业务状态码
          example: 200
        message:
          type: string
          description: 响应信息
          example: "获取课程列表成功"
        data:
          type: object
          properties:
            records:
              type: array
              items:
                $ref: '#/components/schemas/DualTeacherCourseVO'
            total:
              type: integer
              format: int64
              description: 总记录数
              example: 100
            size:
              type: integer
              format: int32
              description: 每页大小
              example: 10
            current:
              type: integer
              format: int32
              description: 当前页码
              example: 1
            pages:
              type: integer
              format: int32
              description: 总页数
              example: 10
    
    SuccessResponse:
      type: object
      properties:
        code:
          type: integer
          description: 业务状态码
          example: 200
        message:
          type: string
          description: 响应信息
          example: "操作成功"
        data:
          type: null
          description: 无数据返回
    
    ErrorResponse:
      type: object
      properties:
        code:
          type: integer
          description: 业务状态码
          example: 400
        message:
          type: string
          description: 错误信息
          example: "参数错误或权限不足"
        data:
          type: null
          description: 无数据返回
    
    CourseRatingDTO:
      type: object
      required:
        - courseId
        - rating
        - content
      properties:
        courseId:
          type: integer
          format: int32
          description: 课程ID
          example: 1
        rating:
          type: integer
          format: int32
          description: 评分(1-5)
          minimum: 1
          maximum: 5
          example: 5
        content:
          type: string
          description: 评价内容
          maxLength: 500
          example: "这门课程非常实用，企业导师的经验分享很有价值"
    
    CourseRatingVO:
      type: object
      properties:
        id:
          type: integer
          format: int32
          description: 评价ID
          example: 1
        courseId:
          type: integer
          format: int32
          description: 课程ID
          example: 1
        courseTitle:
          type: string
          description: 课程标题
          example: "Java企业级开发实战"
        studentId:
          type: integer
          format: int32
          description: 学生ID
          example: 8
        studentName:
          type: string
          description: 学生姓名
          example: "王五"
        rating:
          type: integer
          format: int32
          description: 评分(1-5)
          example: 5
        content:
          type: string
          description: 评价内容
          example: "这门课程非常实用，企业导师的经验分享很有价值"
        createdAt:
          type: string
          format: date-time
          description: 创建时间
          example: "2024-06-15T09:30:00"
        updatedAt:
          type: string
          format: date-time
          description: 更新时间
          example: "2024-06-15T09:30:00"
    
    CourseRatingResponse:
      type: object
      properties:
        code:
          type: integer
          description: 业务状态码
          example: 200
        message:
          type: string
          description: 响应信息
          example: "评价提交成功"
        data:
          $ref: '#/components/schemas/CourseRatingVO'
    
    PagedCourseRatingResponse:
      type: object
      properties:
        code:
          type: integer
          description: 业务状态码
          example: 200
        message:
          type: string
          description: 响应信息
          example: "获取评价列表成功"
        data:
          type: object
          properties:
            records:
              type: array
              items:
                $ref: '#/components/schemas/CourseRatingVO'
            total:
              type: integer
              format: int64
              description: 总记录数
              example: 50
            size:
              type: integer
              format: int32
              description: 每页大小
              example: 10
            current:
              type: integer
              format: int32
              description: 当前页码
              example: 1
            pages:
              type: integer
              format: int32
              description: 总页数
              example: 5
    
    AverageRatingResponse:
      type: object
      properties:
        code:
          type: integer
          description: 业务状态码
          example: 200
        message:
          type: string
          description: 响应信息
          example: "获取平均评分成功"
        data:
          type: number
          format: double
          description: 平均评分
          example: 4.5
    
    HasRatedResponse:
      type: object
      properties:
        code:
          type: integer
          description: 业务状态码
          example: 200
        message:
          type: string
          description: 响应信息
          example: "检查成功"
        data:
          type: boolean
          description: 是否已评价
          example: true
    
    CourseResourceDTO:
      type: object
      required:
        - courseId
        - title
        - resourceType
      properties:
        courseId:
          type: integer
          format: int32
          description: 课程ID
          example: 1
        title:
          type: string
          description: 资源标题
          minLength: 2
          maxLength: 50
          example: "Java高并发编程讲义"
        description:
          type: string
          description: 资源描述
          maxLength: 200
          example: "本讲义包含Java高并发编程的核心概念和实践案例"
        resourceType:
          type: string
          description: 资源类型
          enum: [document, video, code, other]
          example: "document"
    
    CourseResourceVO:
      type: object
      properties:
        id:
          type: integer
          format: int32
          description: 资源ID
          example: 1
        courseId:
          type: integer
          format: int32
          description: 课程ID
          example: 1
        courseTitle:
          type: string
          description: 课程标题
          example: "Java企业级开发实战"
        title:
          type: string
          description: 资源标题
          example: "Java高并发编程讲义"
        description:
          type: string
          description: 资源描述
          example: "本讲义包含Java高并发编程的核心概念和实践案例"
        resourceType:
          type: string
          description: 资源类型分类
          enum: [document, video, code, other]
          example: "document"
        fileUrl:
          type: string
          description: 文件URL
          example: "/resources/courses/1/java-concurrency.pdf"
        fileSize:
          type: integer
          format: int64
          description: 文件大小(字节)
          example: 2048576
        fileType:
          type: string
          description: 文件MIME类型
          example: "application/pdf"
        uploaderId:
          type: integer
          format: int32
          description: 上传者ID
          example: 5
        uploaderName:
          type: string
          description: 上传者姓名
          example: "张三"
        uploaderRole:
          type: string
          description: 上传者角色
          enum: [teacher, mentor]
          example: "teacher"
        createdAt:
          type: string
          format: date-time
          description: 创建时间
          example: "2024-06-10T14:30:00"
    
    CourseResourceResponse:
      type: object
      properties:
        code:
          type: integer
          description: 业务状态码
          example: 200
        message:
          type: string
          description: 响应信息
          example: "资源上传成功"
        data:
          $ref: '#/components/schemas/CourseResourceVO'
    
    PagedCourseResourceResponse:
      type: object
      properties:
        code:
          type: integer
          description: 业务状态码
          example: 200
        message:
          type: string
          description: 响应信息
          example: "获取资源列表成功"
        data:
          type: object
          properties:
            records:
              type: array
              items:
                $ref: '#/components/schemas/CourseResourceVO'
            total:
              type: integer
              format: int64
              description: 总记录数
              example: 30
            size:
              type: integer
              format: int32
              description: 每页大小
              example: 10
            current:
              type: integer
              format: int32
              description: 当前页码
              example: 1
            pages:
              type: integer
              format: int32
              description: 总页数
              example: 3
    
    CourseChapterDTO:
      type: object
      required:
        - courseId
        - title
      properties:
        courseId:
          type: integer
          description: 课程ID
        title:
          type: string
          description: 章节标题
        description:
          type: string
          description: 章节描述
        sequence:
          type: integer
          description: 章节顺序
          
    CourseChapterVO:
      type: object
      properties:
        id:
          type: integer
          description: 章节ID
        courseId:
          type: integer
          description: 课程ID
        courseTitle:
          type: string
          description: 课程标题
        title:
          type: string
          description: 章节标题
        description:
          type: string
          description: 章节描述
        sequence:
          type: integer
          description: 章节顺序
        isPublished:
          type: boolean
          description: 是否已发布
        resourceCount:
          type: integer
          description: 关联资源数量
        createdAt:
          type: string
          format: date-time
          description: 创建时间
        updatedAt:
          type: string
          format: date-time
          description: 更新时间
          
    LearningProgressDTO:
      type: object
      required:
        - chapterId
        - status
      properties:
        chapterId:
          type: integer
          description: 章节ID
        status:
          type: string
          description: 学习状态
          enum: [not_started, in_progress, completed]
        progressPercent:
          type: integer
          description: 完成百分比(0-100)
          
    LearningProgressVO:
      type: object
      properties:
        id:
          type: integer
          description: 进度记录ID
        studentId:
          type: integer
          description: 学生ID
        studentName:
          type: string
          description: 学生姓名
        chapterId:
          type: integer
          description: 章节ID
        chapterTitle:
          type: string
          description: 章节标题
        courseId:
          type: integer
          description: 课程ID
        courseTitle:
          type: string
          description: 课程标题
        status:
          type: string
          description: 学习状态
        progressPercent:
          type: integer
          description: 完成百分比(0-100)
        startTime:
          type: string
          format: date-time
          description: 开始学习时间
        completeTime:
          type: string
          format: date-time
          description: 完成学习时间
        durationMinutes:
          type: integer
          description: 学习时长(分钟)
          
    CourseDiscussionDTO:
      type: object
      required:
        - courseId
        - content
      properties:
        courseId:
          type: integer
          description: 课程ID
        content:
          type: string
          description: 讨论内容
        parentId:
          type: integer
          description: 父讨论ID，用于回复
          
    CourseDiscussionVO:
      type: object
      properties:
        id:
          type: integer
          description: 讨论ID
        courseId:
          type: integer
          description: 课程ID
        courseTitle:
          type: string
          description: 课程标题
        userId:
          type: integer
          description: 发布用户ID
        userName:
          type: string
          description: 发布用户姓名
        userAvatar:
          type: string
          description: 发布用户头像
        userRole:
          type: string
          description: 发布用户角色
        content:
          type: string
          description: 讨论内容
        parentId:
          type: integer
          description: 父讨论ID
        replies:
          type: array
          items:
            $ref: '#/components/schemas/CourseDiscussionVO'
          description: 回复列表
        createdAt:
          type: string
          format: date-time
          description: 创建时间
        updatedAt:
          type: string
          format: date-time
          description: 更新时间
          
    CourseQuestionDTO:
      type: object
      required:
        - courseId
        - title
        - content
      properties:
        courseId:
          type: integer
          description: 课程ID
        chapterId:
          type: integer
          description: 相关章节ID
        title:
          type: string
          description: 问题标题
        content:
          type: string
          description: 问题内容
          
    CourseQuestionVO:
      type: object
      properties:
        id:
          type: integer
          description: 问题ID
        courseId:
          type: integer
          description: 课程ID
        courseTitle:
          type: string
          description: 课程标题
        chapterId:
          type: integer
          description: 相关章节ID
        chapterTitle:
          type: string
          description: 章节标题
        studentId:
          type: integer
          description: 提问学生ID
        studentName:
          type: string
          description: 提问学生姓名
        title:
          type: string
          description: 问题标题
        content:
          type: string
          description: 问题内容
        status:
          type: string
          description: 问题状态
        answer:
          type: string
          description: 回答内容
        answeredBy:
          type: integer
          description: 回答者ID
        answeredByName:
          type: string
          description: 回答者姓名
        answeredByRole:
          type: string
          description: 回答者角色
        answeredAt:
          type: string
          format: date-time
          description: 回答时间
        createdAt:
          type: string
          format: date-time
          description: 创建时间
          
    CourseAttendanceDTO:
      type: object
      required:
        - courseId
        - attendanceDate
        - studentRecords
      properties:
        courseId:
          type: integer
          description: 课程ID
        attendanceDate:
          type: string
          format: date
          description: 出勤日期
        studentRecords:
          type: array
          items:
            $ref: '#/components/schemas/StudentAttendanceRecord'
          description: 学生出勤记录
        remark:
          type: string
          description: 备注
          
    StudentAttendanceRecord:
      type: object
      required:
        - studentId
        - status
      properties:
        studentId:
          type: integer
          description: 学生ID
        status:
          type: string
          description: 出勤状态
          enum: [present, absent, late, leave]
        remark:
          type: string
          description: 备注
          
    CourseAttendanceVO:
      type: object
      properties:
        id:
          type: integer
          description: 出勤记录ID
        courseId:
          type: integer
          description: 课程ID
        courseTitle:
          type: string
          description: 课程标题
        studentId:
          type: integer
          description: 学生ID
        studentName:
          type: string
          description: 学生姓名
        attendanceDate:
          type: string
          format: date
          description: 出勤日期
        status:
          type: string
          description: 出勤状态
        remark:
          type: string
          description: 备注
        recordedBy:
          type: integer
          description: 记录人ID
        recordedByName:
          type: string
          description: 记录人姓名
        createdAt:
          type: string
          format: date-time
          description: 创建时间
          
    ResultVO:
      type: object
      properties:
        code:
          type: integer
          description: 状态码
        message:
          type: string
          description: 消息
        data:
          type: object
          description: 返回数据
