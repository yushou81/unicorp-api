#  开源操作系统复习

# CH01

### Linux发展史

#### 特点

+ 与Unix操作系统兼容
+ 广泛的硬件运行环境
+ 强大的网络功能
+ 对多用户多任务的完美支持
+ 多硬件平台支撑和可移植性
+ 良好的设备独立性

#### 系统界面

+ 图形化用户界面
+ 命令行用户界面
+ CLI模拟器界面

### Android操作系统

#### 分层

+ Linux内核层
+ 系统运行库
+ Android运行时层
+ 应用框架层
+ 应用层

![image-20250606152410628](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250606152410628.png)

![image-20250606152427481](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250606152427481.png)

#### 技术特点

+ 基于Linux内核的宏内核架构
+ 丰富的应用框架与组件模型
+ 应用沙箱与权限安全
+ 庞大的应用生态
+ 多样的设备支持
+ 持续的版本演进
+ 开源与社区

## CH2文件与文件系统

#### 终端的定义

+ 最初只连接主机的大型键盘和显示器
+ 现在：一种输入输出接口，可以是物理的也可以是虚拟的

#### 终端模拟器

+ 在图形界面中模拟终端功能的软件

#### Shell

+ 一个程序，运行在终端，用来解释命令，与操作系统交互
+ 功能：读取用户输入，极细命令语法，执行内置命令或调用系统程序

#### 命令行终端详解

![image-20250607103211499](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250607103211499.png)

![image-20250607103255367](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250607103255367.png)

### Linux文件系统和文件

#### Linux文件系统

+ 一切事物都是文件
+ 典型的单根，分层，树形结构，系统第一级目录为根目录，用符号/表示
+ 字符.开始的文件名为隐藏文件，默认不显示
+ ![image-20250607103810324](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250607103810324.png)

![image-20250607103847376](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250607103847376.png)![image-20250607103908015](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250607103908015.png)

#### 常用命令

![image-20250607104250788](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250607104250788.png)

![image-20250607104439265](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250607104439265.png)

![image-20250607115556666](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250607115556666.png)

![image-20250607141113179](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250607141113179.png)

![image-20250607141416238](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250607141416238.png)

#### 文件三个时间属性

+ mtime：内容修改时间	
+ ctime：属性修改时间
+ atime：访问时间

![image-20250607141623011](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250607141623011.png)

![image-20250608100910626](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608100910626.png)

![image-20250608100926556](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608100926556.png)

![image-20250608101119355](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608101119355.png)

![image-20250608101845839](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608101845839.png)

![image-20250608101904889](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608101904889.png)

![image-20250608101923996](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608101923996.png)

#### 文件属性

![image-20250608102912722](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608102912722.png)

+ file确定文件具体类型

#### ![image-20250608103717931](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608103717931.png) 

### Linux系统中的磁盘和分区

+ 所有设备都被抽象成文件，存储在/dev目录下
+ 分区，将一个磁盘在逻辑上分为几个区，每个区当成独立的磁盘使用如MBR和GPT

![image-20250608110006178](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608110006178.png)

+ 在磁盘分区创建文件系统的过程称为格式化

![image-20250608110206111](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608110206111.png)

### 索引式文件系统

![image-20250608110409841](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608110409841.png)

![image-20250608110542157](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608110542157.png)

+ ![image-20250608152058186](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608152058186.png)
+ ![image-20250608152110934](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608152110934.png)

![image-20250608153458014](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608153458014.png)

Okay, let's answer these questions:

**1. 有了硬链接为什么还需要软链接？ (Why are soft links needed if we have hard links?)**

*   **跨文件系统 (Crossing File Systems):** 硬链接不能跨越不同的文件系统分区。软链接可以，因为它只是一个指向目标文件路径的特殊文件。
*   **链接到目录 (Linking to Directories):** 大多数系统不允许（或不推荐）为目录创建硬链接，因为这可能导致文件系统结构混乱和循环。软链接可以安全地链接到目录。
*   **指示性 (Clarity/Indication):** 软链接明确地表示它是一个“快捷方式”或“别名”。如果原始文件被删除，软链接会变成“悬空链接”（dangling link），这很清楚地表明目标不存在了。硬链接与原始文件是平等的，删除任何一个硬链接（包括“原始”文件名）都不会影响其他链接，直到最后一个链接被删除，文件数据才会被真正移除。
*   **链接到不存在的文件 (Linking to non-existent files):** 软链接可以指向一个尚不存在的文件或目录。当该路径下的文件/目录被创建后，软链接就会生效。硬链接必须指向一个已存在的文件。

**2. 硬链接为什么不能跨文件系统？ (Why can't hard links cross file systems?)**

硬链接是通过多个目录条目指向文件系统中的同一个 **inode** 来实现的。inode 是文件系统内部用来存储文件元数据（如权限、所有者、时间戳以及数据块位置等信息）的数据结构。

*   **Inode 唯一性:** Inode 号码仅在它所属的特定文件系统内是唯一的。不同的文件系统可以有相同 inode 号码的文件，但它们代表完全不同的文件。
*   **文件系统隔离:** 每个文件系统独立管理自己的 inode 表和数据块。一个文件系统的驱动程序无法直接引用或管理另一个文件系统的 inode。

因此，由于硬链接直接与 inode 相关联，而 inode 的作用范围被限制在单个文件系统内，所以硬链接无法跨越文件系统的边界。

**3. 如果你要备份文件内容，应该用硬链接还是软链接？ (If you want to back up file content, should you use a hard link or a soft link?)**

**严格来说，硬链接和软链接都不是真正的备份方法。**

*   **硬链接 (Hard Link):**
    *   它与原始文件共享相同的 inode 和数据块。
    *   如果你修改通过硬链接访问的文件，原始文件的内容也会改变（因为它们是同一个文件）。
    *   如果原始数据块损坏（例如磁盘物理损坏），所有指向该 inode 的硬链接（包括原始文件）都会访问到损坏的数据。
    *   **它不能防止数据损坏或意外修改。** 它只能防止因删除一个文件名而导致文件数据丢失（只要还有其他硬链接存在）。
    *   **优点（非备份层面）：** 节省磁盘空间，因为数据只有一份。

*   **软链接 (Soft Link):**
    *   它只是一个指向原始文件路径的指针。它有自己的 inode 和数据块，但其数据块存储的是目标文件的路径名。
    *   如果原始文件被删除或移动，软链接就会失效（悬空链接）。
    *   它完全不包含文件内容的副本。
    *   **它完全不能作为备份。**

**真正的备份意味着创建文件内容的一个独立副本，存放在不同的位置（最好是不同的物理设备或文件系统上）。** 这通常通过 `cp` (copy) 命令或其他专门的备份工具来实现。

**结论:**
如果你必须在硬链接和软链接之间选择一个来“保留”文件数据（而不是真正的备份），硬链接稍微沾点边，因为它确保了只要至少有一个硬链接存在，文件数据就不会被删除。但是，这绝不是一个可靠的备份策略。

**正确的备份方法是复制文件 (`cp`) 到另一个位置。**

## CH03 用户，进程和网络

### 用户管理

![image-20250608154405756](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608154405756.png)

![image-20250608155008556](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608155008556.png)

![image-20250608155719492](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608155719492.png)

![image-20250608155833889](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608155833889.png)

![image-20250608160247095](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608160247095.png)

![image-20250608160947269](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608160947269.png)

- **w 和 who**: 显示 **当前** 登录的用户。w 更详细，包含用户正在执行的命令和系统负载。
- **last**: 显示 **历史** 登录记录，包括登录、登出和系统重启/关机。
- **lastlog**: 显示每个用户 **最近一次** 的登录信息。

![image-20250608162032529](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608162032529.png)

#### sudo详解

![image-20250608162614018](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608162614018.png)

![image-20250608162627393](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608162627393.png)

![image-20250608162721019](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608162721019.png)

### 进程管理

#### 查看进程基本信息

+ ps -l：将当前登入用户的UID与相关信息列出来
+ ps -aux：列出目前所有在内存中的进程

![image-20250608165550129](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608165550129.png)

![image-20250608165740129](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608165740129.png)

![image-20250608170216514](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608170216514.png)

![image-20250608170457859](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608170457859.png)

![image-20250608170535644](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608170535644.png)

![image-20250608171227684](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250608171227684.png)

### 网络管理

#### 查看网卡相关信息

+ dmesg
+ lspci
+ lsmod
+ modinfo

![image-20250609091114466](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609091114466.png)

#### ping命令

#### ![image-20250609092110657](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609092110657.png)

#### traceroute

+ 通过发送数据包进行路由的跟踪

#### netstat

+ 查看本机的网络状态相关信息

#### 远程连接服务器和SSH

##### Telnet

+ 计算机网络早期使用的客户端连接服务器协议，默认使用23端口
+ 主要特点是简单易用和高效，缺点是明文传输，不安全

##### SSH

+ SSH是Secure Shell的缩写，是一种基于加密机制的安全连接远程服务器Shell的协议

![image-20250609095141332](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609095141332.png)

![image-20250609095837559](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609095837559.png)

![image-20250609100040975](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609100040975.png)

![image-20250609100805803](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609100805803.png)

## CH4Shell脚本编程

### 数据流与重定向

![image-20250609102738852](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609102738852.png)

![image-20250609102848226](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609102848226.png)

![image-20250609104933633](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609104933633.png)

![image-20250609110101359](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609110101359.png)

![image-20250609111247832](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609111247832.png)

![image-20250609111303128](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609111303128.png)

![image-20250609111634709](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609111634709.png)

![image-20250609111917603](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609111917603.png)

![image-20250609111941347](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609111941347.png)

### Shell脚本编程概述

#### Shell

+ Shell是指系统内核程序之上的一系列程序的集合

#### bash Shell的特点

+ 编程功能：支持脚本编程。
+ 表达式功能：支持正则表达式和通配符

#### Shell脚本

+ Shell脚本是一个可执行的纯文本文件，由多个Shell命令组成
+ Shell脚本通过组合Shell内部命令和外部命令，同时结合正则表达式，管道命令，数据流重定向等辅助命令，完成一个完整的功能

#### 执行方式

+ 直接命令执行
+ bash进程执行

#### 命令类型

+ 内部命令：当前Shell自身的一部分，其代码是整个Shell代码的组成部分

+ 外部命令：Shell外的可执行程序，通过调用内部命令或Shell代码完功能
+ 通过环境变量设置的路径搜索外部命令对应可执行程序并执行

![image-20250609151231469](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609151231469.png)

![image-20250609151434342](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609151434342.png)

![image-20250609151827087](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609151827087.png)

### ViM

#### 操作模式

+ 命令模式： 由命令序列组成，完成某些特定动作
+ 插入模式：输入或编辑文本内容

#### 进入与退出

+ vi+文件名
+ 保存退出，输入：wq；退出 ：q！

#### ![image-20250609153047921](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609153047921.png)

![image-20250609153143621](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609153143621.png)

 ![image-20250609153944956](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609153944956.png)

![image-20250609154030059](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609154030059.png)

![image-20250609154150316](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609154150316.png)

![image-20250609154348556](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609154348556.png)

#### 变量

+ sh与bash这行的脚本是局部变量
+ 全局变量必须使用source

![image-20250609160909552](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609160909552.png)

![image-20250609160927793](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609160927793.png)

![image-20250609160949118](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609160949118.png)

![image-20250609161004337](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609161004337.png)

![image-20250609161324690](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609161324690.png)

![image-20250609161356828](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609161356828.png)

![image-20250609161513462](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609161513462.png)

![image-20250609161548586](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609161548586.png)

## CH5系统安全与防火墙

### Linux系统安全

#### 安全概述

+ 系统安全：保障用户文件和进程的访问安全
  + 权限三部曲：基本的UGO模型，特殊权限SUID｜SGID｜SBIT和ACL权限
+ 网络安全：主要通过防火墙技术，对服务器的网络访问进行控制

#### UGO补充

+ 默认权限与umask命令
  + umask用于查看或设定新建文件和目录时的默认权限
  + 新建文件的默认权限=666-umask
  + 新建目录的默认权限=777-umask

![image-20250609193034048](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609193034048.png)

![image-20250609193237318](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609193237318.png)

![image-20250609193721940](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609193721940.png)

#### 设置修改三种特殊权限

+ 421分别为SUID,SGID,SBIT。

### ACL权限

+ 访问控制列表，用于在传统的UGO模型之上提供更加细粒度的权限管理
+ ACL可以正对单一用户，单一文件或目录进行rwx的权限管理

![image-20250609194810766](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609194810766.png)

#### SELinux

+ 针对特定的进程和特定的文件进行专门的权限控制
+ 主体：运行中的程序，进程；
+ 目标：即进程想要访问的资源/文件

![image-20250609200824229](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609200824229.png)

#### SEXLinux三种运行模式

+ enforcing：强制模式，代表SELinux在运行中，且以正确的根据策略和安全上下文控制访问
+ Permissive：宽容模式，代表SELinux在运行中，并不限制访问，只提供警告
+ disabled：关闭模式

![image-20250609202742686](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609202742686.png)

![image-20250609203250296](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609203250296.png)

![image-20250609203956823](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609203956823.png)

### 防火墙技术

+ 防火墙是一种隔离系统内部网络和外部网络的过滤技术
+ 分为硬件防火墙和软件防火墙
+ 软件防火墙分为包过滤防火墙和代理服务防火墙
+ 包过滤防火墙采用数据包过滤技术，在网络层依据的预设的过滤规则对数据包进行选择
+ 代理服务防火墙也称为链路级网关，将所有跨越防火墙的网络通信分为两段，中间由代理服务进行转发，实现过滤

#### Linux防火墙技术

+ Netfilter，iptables，nftables，firewall，ufw

![image-20250609204804553](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609204804553.png)

#### Nerfilter

+ 数据包过滤，连接跟踪，地址转换
+ 过滤特定数据包，修改数据包的内容再转发
+ 定义一系列的hook点，每个hook点上可以挂在多个hook函数，hook函数中实现对数据包的处理

#### iptables

+ 四表五链
+ 表：用来存储过滤规则的表
  + filter表：保存数据包是否放行
  + nat表：保存在进行网络地址转换的规则
  + mangle表：保存对数据包头部其他内容进行修改的规则
  + raw表：保存数据包是否被跟踪的规则
+ 链：路由前prerouting，入站input，转发forward，出站output，路由后postouting
+ 基本原理就是在数据包进入到网卡后的不同阶段，查找对应表，用相关的规则对数据包进行处理

![image-20250609210241800](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609210241800.png)

#### nftables

+ 简洁的语法
+ 性能与扩展
+ 内核中的规则存储结构优化
+ 功能增强
+ 兼容性

#### firewall

![image-20250609210524566](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609210524566.png)

#### 防火墙的使用

+ 查看状态：firewall -cmd-state
+ 关闭：systemctl stop firewalld.service
+ 开始：systemctl start firewalls.service

![image-20250609210926119](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609210926119.png)

#### Linux防火墙实用范例

![image-20250609212421271](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609212421271.png)

![image-20250609212536500](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609212536500.png)

![image-20250609212633025](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609212633025.png)

![image-20250609212745280](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250609212745280.png)

## CH6引导日志和计划任务

### Linux系统引导

+ 系统引导：开始于打开计算机电源，结束于内核初始化完成和init或systemd进程成功运行
+ 系统启动：init或systemd进程接管工作，运行相关程序，知道用户可以正常操作计算机

#### 引导流程

+ BIOS/UEFI固件阶段：上电后主板固件运行硬件自检，初始化CPU，内存和基础设备
+ 引导加载程序阶段：固件从启动设备读取引导加载程序
+ 内核加载与初始化：内核获得控制权后，完成硬件驱动初始化，挂载根文件系统，启动第一个用户态进程
+ init阶段：init进程接管，按照预定义的启动脚本或unit单元启动系统服务和守护进程，进入指定的运行级别或目标环境
+ 用户空间启动：启动登录管理器或终端，用户看到登录提示

### 系统引导

#### BIOS与UEFI

+ BIOS从预定义的位置加载固定大小的引导代码，UEFI支持灵活地制定启动文件或分区
+ UEFI为取代BIOS而生，提供更强大的扩展能力，UEFI固件带有微型操作系统的运行环境，支持图形话，而BIOS笔记哦啊简陋
+ BIOS使用传统的MBR分区表，UEFI支持GUID分区能处理更大的存储设备，UEFI还实现了安全启动机制
+ BIOS设置存储在主板CMOS中，容量有限；UEFI则使用主板闪存和NVRAM变量来存储配置
+ 共同直接是在硬件上电自检后，将控制权交给下一级的引导加载程序

#### GRUB

+ 引导程序负责从固件接管控制，加载操作系统内核
+ 功能：GRUB提供启动菜单，让用户选择不同的内核版本或操作系统
+ 对于BIOS启动，MBR中的GRUB第一阶段代码加载后，会定位到GRUB核心，然后显示菜单，根据用户选择加载，交给内核
+ 对于UEFI启动，主板固件直接从EFI分区加载GRUB的EFI可执行文件。然后与BIOS一致
+ GRUB引导程序由引导配置文件定义

### init进程和systemd机制

+ init进程是第一个进程，担任系统初始化和管理职责

#### 主要工作

+ 运行级别和系统目标：使用运行级别定义系统状态
+ 挂载文件系统与配置
+ 启动终端/图形界面
+ 启动系统服务

#### 缺点

+ 启动时间长
+ 启动脚本复杂

### systmed

#### 主要特点

+ 守护进程被称为unit，unit按功能分为多种不同类型，多个unit可以组合成一个服务组
+ 所有守护进程全部并行处理，加速开机启动流程，同时自动完成多个守护进程的依赖性检查
+ 使用systemctl命令进行守护进程的统一管理
+ 向下兼容init

![image-20250610093528370](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610093528370.png)

### 日志系统

#### 日志简介

+ systemd-journald和rsyslogd两种日志系统journald负责收集日志，rsyslogd负责输出持久化日志

![image-20250610093739363](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610093739363.png)

#### 日志的配置文件

+ 功能：规定哪些服务的什么等级信息需要记录在哪个文件
+ 保存在/etc/log/.conf

### Web服务器日志

+ 访问日志
+ 错误日志

### 计划任务

+ 例行性任务：按照设定的周期自动循环多次执行的工作
+ 单次计划任务：按照设定的某一时间只执行一次的工作

![image-20250610094946340](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610094946340.png)

![image-20250610095537536](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610095537536.png)

![image-20250610095603811](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610095603811.png)

![image-20250610095838278](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610095838278.png)

## CH7文件服务器

### Linux文件传输和文件共享简介

+ wget用于在Linux系统中下载文件
+ scp网间拷贝，作用是把文件从一台计算机拷贝到网络上的另一台计算机

### 文件服务器

+ 文件服务器是一种专门用于存储，管理和共享文件的计算机系统或者设备，主要功能是通过网络向其他计算机提供文件访问服务
+ Linux操作系统由于其稳定性和安全性，被广泛用于构建文件服务器

### 常用文件共享服务

#### NFS

+ 用于类Unix系统之间通过网络共享文件系统
+ 核心思想是允许一台机器将其本地文件系统的一部分导出给网络上的其他主机，是远程主机能够通过网络挂载这个文件系统，并像访问本地磁盘一样访问其中的文件
+ 采用CS结构，NFS服务器负责共享本地文件系统，客户端负责通过网络挂载改远程文件系统

![image-20250610103126845](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610103126845.png)

### Samba

+ 有服务器和客户端组成，实现SMB/CIFS协议
+ SMB服务器消息块
+ SMB协议是由状态的，绘画期间服务器维护客户端的链接状态和用户认证信息，它支持多种共享模式和安全模式
+ 跨平台文件访问：实现了跨操作系统的文件共享兼容性

#### 工作机制

+ 主要包含两个守护进程：smbd和nmbd
+ smbd提供核心的文件和打印共享服务，实现SMB协议的主要功能
+ nmbd提供NetBIOS名字服务和浏览功能



### FTP

+ 允许用户将文件在本地和远程上传或下载

#### 协议特点

+ 使用两个TCP端口来进行通信
+ 控制连接：默认使用TCP端口21
+ 数据连接：用于传输文件数据，在需要传输文件或目录列表时建立，完成后关闭

![image-20250610105017019](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610105017019.png)

### Git

![image-20250610105132143](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610105132143.png)

![image-20250610105224802](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610105224802.png)

## CH8Web服务器概述和Nginx入门

![image-20250610105448276](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610105448276.png)

![image-20250610105550508](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610105550508.png)

![image-20250610105706675](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610105706675.png)

![image-20250610105821989](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610105821989.png)

### Nginx入门

![image-20250610105853910](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610105853910.png)

![image-20250610105935885](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610105935885.png)

![image-20250610110119238](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610110119238.png)

![image-20250610110238026](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610110238026.png)

### 代理服务器

+ 正向代理服务器：一个位于客户端和目标服务器之间的服务器，该服务器根据客户端请求，从原始服务器获取网页或资源然后转发给客户端
+ 反向代理服务器：根据客户端的请求，将请求根据某种策略转发到不同的服务器上，某台服务器提供响应后，反向代理服务器将响应转发给客户端

![image-20250610110716477](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610110716477.png)

## CH09Nginx进阶

### HTTPS服务器

![image-20250610144613161](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610144613161.png)

![image-20250610145600570](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610145600570.png)

![image-20250610151045012](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610151045012.png)

![image-20250610151112216](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610151112216.png)

![image-20250610151129863](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610151129863.png)

![image-20250610151810108](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610151810108.png)

### Linux进程基本原理

#### fork函数

+ fork函数可以启动一个新进程，其方法是复制当前进程
+ fork函数在进程表中创建一个新的表项，新表项有自己的数据空间环境和文件描述

![image-20250610152053482](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610152053482.png)

![image-20250610152339746](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610152339746.png)

![image-20250610152459568](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610152459568.png)

![image-20250610153015436](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610153015436.png)

![image-20250610153231632](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610153231632.png)

![image-20250610154204740](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610154204740.png)

![image-20250610154414069](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610154414069.png)

#### 信号机制

+ 生成表示一个信号的产生，捕获表示接受到一个信号
+ ![image-20250610154629445](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610154629445.png)

![image-20250610154828148](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610154828148.png)

![image-20250610154925747](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610154925747.png)

## CH10

### 缓存服务器

#### 缓存

+ 缓存是一种临时存储数据的技术，一般将数据存储到内存中，提高是苏剧访问速度和系统性能
+ 作用：临时保存数据，避免频繁的访问数据库，提高系统性能和降低访问时延

#### 分类

+ 本地缓存：应用中的缓存组件
+ 分布式缓存：与应用分离的缓存组件

### Redis

+ 采用键值对存储数据，允许其他应用通过tcp协议读写字典中的内容
+ 数据库的所有数据存储在内存中

#### 优点

+ 速度快
+ 存储数据的数据结构专门设计
+ 丰富的数据类型
+ 丰富的特性
+ 原子性，支持事务

![image-20250610163735703](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610163735703.png)

![image-20250610164136264](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610164136264.png)

![image-20250610164202140](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610164202140.png)

![image-20250610164214242](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610164214242.png)

#### 持久化方式

+ RDB，将redis存储的数据生成快照并存储到磁盘
+ AOF，将redis执行过的指令记录下来，在下次重启时将指令从前到后重复执行一遍

![image-20250610164806558](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610164806558.png)

![image-20250610164836104](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610164836104.png)

![image-20250610164921240](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610164921240.png)

### 容器技术

+ Docker是目前容器技术理论的主流实现方式，是一个用于构建，运行，传送应用程序的平台

![image-20250610165645451](/Users/zhaoyang/Library/Application Support/typora-user-images/image-20250610165645451.png)